# RawKit

macOS RAW 图像预览和处理工具,支持 Sony A7R4、Sigma DPQ 等相机的 RAW 格式以及常规图像格式。

## 功能特性

### 图像格式支持
- RAW 格式: ARW (Sony)、X3F (Sigma)、CR2/CR3 (Canon)、NEF (Nikon)、ORF (Olympus)、RAF (Fujifilm)、RW2 (Panasonic)、DNG 等
- 常规格式: JPEG、PNG、TIFF

### 图像查看
- 缩放和平移操作（支持手势和鼠标滚轮）
- 双击重置缩放
- 渐进式加载（缩略图 → 中等分辨率 → 完整分辨率）
- 实时直方图显示（RGB 和亮度通道）
- 像素级颜色信息查看（RGB、HSL 值）
- 文件元数据和色彩空间信息显示

### 实时图像调整
- **基础调整**
  - 曝光调整（EV 方式）
  - 线性曝光（适用于 HDR）
  - 亮度控制
  - 对比度调整
  - 白色色阶
  - 高光恢复
  - 阴影提升
  - 黑色色阶
- **色彩调整**
  - 白平衡（色温 2000-10000K，默认 5500K 日光白平衡）
  - 自动白平衡（基于 OpenCV Gray World 算法）
  - 白平衡取色工具（点击取色）
  - 色调微调（品红-绿色轴）
  - 饱和度
  - 自然饱和度
  - RGB 主曲线调整
  - 红/绿/蓝独立通道曲线
  - 亮度曲线
  - 三点校色（黑/灰/白点取样）
  - LUT 支持（.cube .3dl .lut 格式，可调透明度和输入色彩空间）
- **细节调整**
  - 清晰度
  - 去雾
  - 锐化
- **变换操作**
  - 旋转（90° 增量）
  - 水平镜像
  - 垂直镜像

### 工作流程增强
- 撤销/重做支持（⌘Z / ⌘⇧Z）
- 分组重置（基础/色彩/细节各组独立重置）
- 全局重置（保留变换和 LUT 设置）
- 调整历史记录
- 实时预览

### 导出功能
- **TIFF (16-bit)**：无损压缩，适合打印和后期处理（推荐）
- **JPEG**：有损压缩，可调质量，适合网络分享
- **HEIF**：高效压缩，适合 Apple 生态系统
- **DNG (16-bit)**：数字底片格式，保留高动态范围
- 支持多种色彩空间（sRGB、Display P3、Adobe RGB、ProPhoto RGB）
- 应用所有调整后导出
- 可配置输出尺寸和文件命名

### 文件管理
- 拖放文件支持
- 批量导入
- 文件夹浏览
- 自动提取 RAW 原始白平衡

## 技术栈

- Swift 6.0
- SwiftUI (macOS 14+)
- Core Image (实时图像处理)
- CGImageSource (RAW 解码)
- Actor 并发模型

## 构建和运行

1. 打开 Xcode 项目:
   ```bash
   open RawKit.xcodeproj
   ```

2. 选择目标设备为 "My Mac"

3. 点击运行按钮 (⌘+R) 或 Product > Run

## 系统要求

- macOS 14.0+
- Xcode 15.0+ (用于开发和编译)
- 8GB+ RAM (推荐用于处理大型 RAW 文件)
